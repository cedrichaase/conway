var Canvas=function(){function a(a){this.renderInterval=100,this.element=a,this.$element=$(a),this.ctx=a.getContext("2d")}return a.prototype.getMouse=function(a){var b=this.$element.offset(),c=a.pageX-b.left,d=a.pageY-b.top;return new Vector2D(c,d)},a.prototype.clear=function(){this.ctx.clearRect(0,0,this.element.width,this.element.height)},a.prototype.toggleActive=function(){this.active?this.stop():this.start()},a.prototype.stop=function(){this.active&&(clearInterval(this.interval),this.active=!1)},a.prototype.start=function(){if(!this.active){var a=this;this.interval=setInterval(function(){a.render()},this.renderInterval),this.active=!0}},a.prototype.render=function(){this.clear()},a}(),Vector2D=function(){function a(a,b){this.x=a,this.y=b}return a}(),Cell=function(){function a(a,b){this.coords=a,this.value=b}return a.prototype.toggleValue=function(){this.value=!this.value},a.prototype.getCoordsTopLeft=function(){return new Vector2D(this.coords.x-1,this.coords.y-1)},a.prototype.getCoordsTop=function(){return new Vector2D(this.coords.x,this.coords.y-1)},a.prototype.getCoordsTopRight=function(){return new Vector2D(this.coords.x+1,this.coords.y-1)},a.prototype.getCoordsRight=function(){return new Vector2D(this.coords.x+1,this.coords.y)},a.prototype.getCoordsBottomRight=function(){return new Vector2D(this.coords.x+1,this.coords.y+1)},a.prototype.getCoordsBottom=function(){return new Vector2D(this.coords.x,this.coords.y+1)},a.prototype.getCoordsBottomLeft=function(){return new Vector2D(this.coords.x-1,this.coords.y+1)},a.prototype.getCoordsLeft=function(){return new Vector2D(this.coords.x-1,this.coords.y)},a}(),Grid=function(){function a(a,b){this.width=a,this.height=b,this.matrix=[];for(var c=0;a>c;c++){this.matrix[c]=[];for(var d=0;b>d;d++){var e=new Vector2D(c,d);this.matrix[c][d]=new Cell(e,!1)}}}return a.prototype.getCell=function(a){var b=a.x,c=a.y,d=new Cell(a,!1);return 0>b||0>c||b>=this.width||c>=this.height||(d=this.matrix[b][c]),d},a.prototype.getNeighbors=function(a){var b=new NeighborCoordinates(a),c=new NeighborCells;return c.topLeft=this.getCell(b.topLeft),c.top=this.getCell(b.top),c.topRight=this.getCell(b.topRight),c.right=this.getCell(b.right),c.bottomRight=this.getCell(b.bottomRight),c.bottom=this.getCell(b.bottom),c.bottomLeft=this.getCell(b.bottomLeft),c.left=this.getCell(b.left),c},a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},GridCanvas=function(a){function b(b,c,d){a.call(this,b),this.grid=new Grid(c,d),this.showGrid=!0,this.addEventListeners(),this.start()}return __extends(b,a),b.prototype.toggleShowGrid=function(){this.showGrid=!this.showGrid},b.prototype.drawGrid=function(){for(var a=this.element.width,b=this.element.height,c=a/this.grid.width,d=b/this.grid.height,e=0;e<=this.grid.width;e++){var f=e*c;this.drawVerticalLine(f,this.lineWidth,this.gridColor)}for(var g=0;g<=this.grid.height;g++){var h=g*d;this.drawHorizontalLine(h,this.lineWidth,this.gridColor)}},b.prototype.drawVerticalLine=function(a,b,c){var d=this.element.height;this.ctx.save(),this.ctx.strokeStyle=c,this.ctx.fillStyle=c,this.ctx.lineWidth=b,this.ctx.beginPath(),this.ctx.moveTo(a,0),this.ctx.lineTo(a,d),this.ctx.stroke(),this.ctx.restore()},b.prototype.drawHorizontalLine=function(a,b,c){var d=this.element.width;this.ctx.save(),this.ctx.strokeStyle=c,this.ctx.fillStyle=c,this.ctx.lineWidth=b,this.ctx.beginPath(),this.ctx.moveTo(0,a),this.ctx.lineTo(d,a),this.ctx.stroke(),this.ctx.restore()},b.prototype.fillCellAtCoords=function(a){var b=this.element.width/this.grid.width,c=this.element.height/this.grid.height,d=a.x*b,e=a.y*c;this.ctx.save(),this.ctx.fillRect(d,e,b,c),this.ctx.restore()},b.prototype.drawGridMatrix=function(){for(var a=this.grid.matrix,b=0;b<a.length;b++)for(var c=0;c<a[b].length;c++)if(a[b][c].value){var d=new Vector2D(b,c);this.fillCellAtCoords(d)}},b.prototype.canvasToGridCoords=function(a){var b=a.x,c=a.y,d=Math.floor(b/this.element.width*this.grid.width),e=Math.floor(c/this.element.height*this.grid.height);return new Vector2D(d,e)},b.prototype.addEventListeners=function(){var a=this;this.element.addEventListener("mousedown",function(b){var c=a.getMouse(b),d=a.canvasToGridCoords(c),e=a.grid.getCell(d);e.toggleValue()})},b.prototype.render=function(){a.prototype.clear.call(this),this.showGrid&&this.drawGrid(),this.drawGridMatrix()},b}(Canvas),NeighborCells=function(){function a(){}return a}(),NeighborCoordinates=function(){function a(a){this.topLeft=a.getCoordsTopLeft(),this.top=a.getCoordsTop(),this.topRight=a.getCoordsTopRight(),this.right=a.getCoordsRight(),this.bottomRight=a.getCoordsBottomRight(),this.bottom=a.getCoordsBottom(),this.bottomLeft=a.getCoordsBottomLeft(),this.left=a.getCoordsLeft()}return a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ConwayCanvas=function(a){function b(b,c,d){a.call(this,b,c,d),this.grid=new ConwayGrid(c,d),this.executing=!1}return __extends(b,a),b.prototype.toggleExecution=function(){this.executing=!this.executing},b.prototype.render=function(){a.prototype.render.call(this),this.executing&&(this.grid=this.grid.executeConway())},b}(GridCanvas),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ConwayGrid=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b.prototype.countLiveNeighbors=function(a){var b=this.getNeighbors(a),c=0;return b.top.value&&c++,b.bottom.value&&c++,b.left.value&&c++,b.right.value&&c++,b.topLeft.value&&c++,b.topRight.value&&c++,b.bottomLeft.value&&c++,b.bottomRight.value&&c++,c},b.prototype.livesInNextGeneration=function(a){var b=this.countLiveNeighbors(a);return a.value===!0&&2>b?!1:a.value===!0&&4>b&&b>1?!0:a.value===!0&&b>3?!1:a.value===!1&&3===b?!0:!1},b.prototype.executeConway=function(){for(var a=new b(this.width,this.height),c=this.width,d=this.height,e=0;c>e;e++)for(var f=0;d>f;f++){var g=new Vector2D(e,f),h=this.getCell(g),i=a.getCell(g);i.value=this.livesInNextGeneration(h)}return a},b}(Grid);