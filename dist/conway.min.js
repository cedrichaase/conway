var Vector=function(){function a(){}return a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Vector2D=function(a){function b(b,c){a.call(this),this.x=b,this.y=c}return __extends(b,a),b}(Vector),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Vector3D=function(a){function b(b,c,d){a.call(this),this.x=b,this.y=c,this.z=d}return __extends(b,a),b}(Vector),DecrementClickBehavior=function(){function a(){}return a.prototype.click=function(a){a.decrementValue()},a}(),IncrementClickBehavior=function(){function a(){}return a.prototype.click=function(a){a.incrementValue()},a}(),ToggleClickBehavior=function(){function a(){}return a.prototype.click=function(a){a.toggleValue()},a}(),Cell=function(){function a(a,b){this.coords=a,this.value=b,this.observers=[]}return a.prototype.click=function(){this.clickBehavior.click(this)},a.prototype.registerObserver=function(a){this.observers.push(a)},a.prototype.removeObserver=function(a){},a.prototype.publish=function(){for(var a=0,b=this.observers;a<b.length;a++){var c=b[a];c.update(this)}},a.prototype.setValue=function(a){this.value=a,this.publish()},a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Cell2D=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b.prototype.getCoordsTopLeft=function(){return new Vector2D(this.coords.x-1,this.coords.y-1)},b.prototype.getCoordsTop=function(){return new Vector2D(this.coords.x,this.coords.y-1)},b.prototype.getCoordsTopRight=function(){return new Vector2D(this.coords.x+1,this.coords.y-1)},b.prototype.getCoordsRight=function(){return new Vector2D(this.coords.x+1,this.coords.y)},b.prototype.getCoordsBottomRight=function(){return new Vector2D(this.coords.x+1,this.coords.y+1)},b.prototype.getCoordsBottom=function(){return new Vector2D(this.coords.x,this.coords.y+1)},b.prototype.getCoordsBottomLeft=function(){return new Vector2D(this.coords.x-1,this.coords.y+1)},b.prototype.getCoordsLeft=function(){return new Vector2D(this.coords.x-1,this.coords.y)},b}(Cell),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Cell2DBool=function(a){function b(b,c,d){a.call(this,b,c),this.clickBehavior=d}return __extends(b,a),b.prototype.toggleValue=function(){this.setValue(!this.value)},b}(Cell2D),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Cell2DNumber=function(a){function b(b,c,d){a.call(this,b,c),this.clickBehavior=d}return __extends(b,a),b.prototype.incrementValue=function(){this.setValue(this.value+1)},b.prototype.decrementValue=function(){this.setValue(this.value-1)},b}(Cell2D),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},Cell3D=function(a){function b(b,c){a.call(this,b,c)}return __extends(b,a),b}(Cell),Canvas=function(){function a(a){this.renderInterval=50,this.element=a,this.$element=$(a),this.ctx=a.getContext("2d"),this.width=a.width,this.height=a.height}return a.prototype.getMouse=function(a){var b=this.$element.offset(),c=a.pageX-b.left,d=a.pageY-b.top;return new Vector2D(c,d)},a.prototype.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},a.prototype.toggleActive=function(){this.active?this.stop():this.start()},a.prototype.stop=function(){this.active&&(clearInterval(this.interval),this.active=!1)},a.prototype.start=function(){if(!this.active){var a=this;this.interval=setInterval(function(){a.render()},this.renderInterval),this.active=!0}},a.prototype.render=function(){this.clear()},a}(),Grid=function(){function a(a,b){this.width=a,this.height=b,this.matrix=[];for(var c=0;a>c;c++){this.matrix[c]=[];for(var d=0;b>d;d++){var e=new Vector2D(c,d);this.matrix[c][d]=new Cell2D(e,!1)}}}return a.prototype.getCell=function(a){var b=a.x,c=a.y,d=new Cell2D(a,!1);return 0>b||0>c||b>=this.width||c>=this.height||(d=this.matrix[b][c]),d},a.prototype.getNeighbors=function(a){var b=new NeighborCoordinates(a),c=new NeighborCells;return c.topLeft=this.getCell(b.topLeft),c.top=this.getCell(b.top),c.topRight=this.getCell(b.topRight),c.right=this.getCell(b.right),c.bottomRight=this.getCell(b.bottomRight),c.bottom=this.getCell(b.bottom),c.bottomLeft=this.getCell(b.bottomLeft),c.left=this.getCell(b.left),c},a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},GridCanvas=function(a){function b(b,c,d){a.call(this,b),this.gridColor="#000",this.padding=15.5,this.grid=new Grid(c,d);for(var e=0,f=this.grid.matrix;e<f.length;e++)for(var g=f[e],h=0;h<g.length;h++){var i=g[h];i.registerObserver(this)}this.gridNeedsRedraw=!0,this.addEventListeners(),this.start()}return __extends(b,a),b.prototype.drawGrid=function(){var a=this.width,b=this.height,c=a/this.grid.width,d=b/this.grid.height;this.ctx.save(),this.ctx.translate(.5,.5);for(var e=1;e<=this.grid.width;e++){var f=e*c;this.drawVerticalLine(f,this.lineWidth,this.gridColor)}for(var g=1;g<=this.grid.height;g++){var h=g*d;this.drawHorizontalLine(h,this.lineWidth,this.gridColor)}this.ctx.restore()},b.prototype.drawVerticalLine=function(a,b,c){var d=this.height;this.ctx.save(),this.ctx.strokeStyle=c,this.ctx.fillStyle=c,this.ctx.lineWidth=b,this.ctx.beginPath(),this.ctx.moveTo(a,0),this.ctx.lineTo(a,d),this.ctx.stroke(),this.ctx.restore()},b.prototype.drawHorizontalLine=function(a,b,c){var d=this.width;this.ctx.save(),this.ctx.strokeStyle=c,this.ctx.fillStyle=c,this.ctx.lineWidth=b,this.ctx.beginPath(),this.ctx.moveTo(0,a),this.ctx.lineTo(d,a),this.ctx.stroke(),this.ctx.restore()},b.prototype.fillCellAtCoords=function(a,b){var c=this.width/this.grid.width,d=this.height/this.grid.height,e=a.x*c,f=a.y*d;this.ctx.save(),this.ctx.fillStyle=b,this.ctx.fillRect(e,f,c,d),this.ctx.restore()},b.prototype.clearCellAtCoords=function(a){var b="#FFF",c=this.width/this.grid.width,d=this.height/this.grid.height,e=a.x*c,f=a.y*d;this.ctx.save(),this.ctx.fillStyle=this.gridColor,this.ctx.fillRect(e,f,c,d),this.ctx.restore(),this.ctx.save(),this.ctx.fillStyle=b,this.ctx.fillRect(e+1,f+1,c-1,d-1),this.ctx.restore()},b.prototype.fillCell=function(a){this.fillCellAtCoords(a,"#000")},b.prototype.clearCell=function(a){this.fillCellAtCoords(a,"#FFF")},b.prototype.drawGridMatrix=function(){for(var a=this.grid.matrix,b=0;b<a.length;b++)for(var c=0;c<a[b].length;c++)if(a[b][c].value){var d=new Vector2D(b,c);this.fillCell(d)}},b.prototype.canvasToGridCoords=function(a){var b=a.x,c=a.y,d=Math.floor(b/this.width*this.grid.width),e=Math.floor(c/this.height*this.grid.height);return new Vector2D(d,e)},b.prototype.addEventListeners=function(){var a=this;this.element.addEventListener("mousedown",function(b){var c=a.getMouse(b),d=a.canvasToGridCoords(c),e=a.grid.getCell(d);e.click(),a.update(e)})},b.prototype.render=function(){this.gridNeedsRedraw&&(a.prototype.clear.call(this),this.drawGrid(),this.gridNeedsRedraw=!1)},b.prototype.update=function(a){a.value?this.fillCell(a.coords):this.clearCellAtCoords(a.coords)},b}(Canvas),NeighborCells=function(){function a(){}return a}(),NeighborCoordinates=function(){function a(a){this.topLeft=a.getCoordsTopLeft(),this.top=a.getCoordsTop(),this.topRight=a.getCoordsTopRight(),this.right=a.getCoordsRight(),this.bottomRight=a.getCoordsBottomRight(),this.bottom=a.getCoordsBottom(),this.bottomLeft=a.getCoordsBottomLeft(),this.left=a.getCoordsLeft()}return a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ConwayCanvas=function(a){function b(b,c,d){a.call(this,b,c,d),this.grid=new ConwayGrid(c,d,this),this.executing=!1}return __extends(b,a),b.prototype.toggleExecution=function(){this.executing=!this.executing},b.prototype.render=function(){a.prototype.render.call(this),this.executing&&(this.grid=this.grid.executeConway())},b.prototype.setRenderInterval=function(a){this.stop(),this.renderInterval=a,this.start()},b}(GridCanvas),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ConwayCell=function(a){function b(b,c){a.call(this,b,c,new ToggleClickBehavior)}return __extends(b,a),b.prototype.isAlive=function(){return this.value===!0},b}(Cell2DBool),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ConwayGrid=function(a){function b(b,c,d){a.call(this,b,c);for(var e=0;b>e;e++){this.matrix[e]=[];for(var f=0;c>f;f++){var g=new Vector2D(e,f);this.matrix[e][f]=new ConwayCell(g,!1)}}this.canvas=d}return __extends(b,a),b.prototype.countLiveNeighbors=function(a){var b=this.getNeighbors(a),c=0;return b.top.value&&c++,b.bottom.value&&c++,b.left.value&&c++,b.right.value&&c++,b.topLeft.value&&c++,b.topRight.value&&c++,b.bottomLeft.value&&c++,b.bottomRight.value&&c++,c},b.prototype.livesInNextGeneration=function(a){var b=this.countLiveNeighbors(a);return a.isAlive()&&2>b?!1:a.isAlive()&&4>b&&b>1?!0:a.isAlive()&&b>3?!1:a.isAlive()||3!==b?!1:!0},b.prototype.executeConway=function(){for(var a=new b(this.width,this.height,this.canvas),c=this.width,d=this.height,e=0;c>e;e++)for(var f=0;d>f;f++){var g=new Vector2D(e,f),h=this.getCell(g),i=a.getCell(g),j=this.livesInNextGeneration(h);i.setValue(j),i.value!==h.value&&this.canvas.update(i)}return a},b.prototype.getCell=function(a){var b=a.x,c=a.y,d=new ConwayCell(a,!1);return 0>b||0>c||b>=this.width||c>=this.height||(d=this.matrix[b][c]),d},b}(Grid);